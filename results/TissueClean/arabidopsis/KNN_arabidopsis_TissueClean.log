KNN True TissueClean
Loading data...
RNAseq data shape: (19415, 37335)
Data loaded. Time elapsed: 36.78822675603442
(19415, 37335) (19415,)
['Other', 'Root', 'WholePlant', 'Seedling', 'Seed', 'Shoot', 'Leaf', 'Flower', 'Inflorescence', 'Stigma', 'Internode', 'Hypotocyl', 'Cotyledon', 'Vasculature', 'Petal', 'Anther', 'Carpel', 'Root cell', 'Sepal', 'Petiole', 'Stamen', 'Pistil', 'Reproductive- Other']
Training data shapes: (13590, 37335), (13590,)
Test data shapes: (5825, 37335), (5825,)
Train / test splitting done. Time elapsed: 3.209315988002345
Beginning Model Training and Selection using Hyperopt
  0%|          | 0/60 [00:00<?, ?trial/s, best loss=?]  2%|▏         | 1/60 [09:07<8:58:38, 547.77s/trial, best loss: -0.9543069120361434]  3%|▎         | 2/60 [18:07<8:44:53, 542.99s/trial, best loss: -0.965891173566294]   5%|▌         | 3/60 [27:04<8:33:14, 540.25s/trial, best loss: -0.965891173566294]  7%|▋         | 4/60 [36:09<8:25:52, 542.02s/trial, best loss: -0.965891173566294]  8%|▊         | 5/60 [45:09<8:16:22, 541.50s/trial, best loss: -0.965891173566294] 10%|█         | 6/60 [54:16<8:08:55, 543.26s/trial, best loss: -0.965891173566294] 12%|█▏        | 7/60 [1:03:21<8:00:19, 543.77s/trial, best loss: -0.965891173566294] 13%|█▎        | 8/60 [1:12:24<7:51:09, 543.64s/trial, best loss: -0.965891173566294] 15%|█▌        | 9/60 [1:21:27<7:41:46, 543.27s/trial, best loss: -0.965891173566294] 17%|█▋        | 10/60 [1:30:24<7:31:18, 541.56s/trial, best loss: -0.965891173566294] 18%|█▊        | 11/60 [1:39:30<7:23:13, 542.73s/trial, best loss: -0.965891173566294] 20%|██        | 12/60 [1:48:40<7:16:03, 545.07s/trial, best loss: -0.965891173566294] 22%|██▏       | 13/60 [1:57:55<7:09:18, 548.05s/trial, best loss: -0.965891173566294] 23%|██▎       | 14/60 [2:07:01<6:59:46, 547.53s/trial, best loss: -0.965891173566294] 25%|██▌       | 15/60 [2:16:11<6:51:11, 548.26s/trial, best loss: -0.965891173566294] 27%|██▋       | 16/60 [2:25:12<6:40:21, 545.94s/trial, best loss: -0.965891173566294] 28%|██▊       | 17/60 [2:34:27<6:33:20, 548.85s/trial, best loss: -0.965891173566294] 30%|███       | 18/60 [2:43:24<6:21:35, 545.13s/trial, best loss: -0.965891173566294] 32%|███▏      | 19/60 [2:52:23<6:11:22, 543.47s/trial, best loss: -0.965891173566294] 33%|███▎      | 20/60 [3:01:30<6:02:59, 544.50s/trial, best loss: -0.965891173566294] 35%|███▌      | 21/60 [3:10:41<5:55:12, 546.47s/trial, best loss: -0.965891173566294] 37%|███▋      | 22/60 [3:19:35<5:43:34, 542.48s/trial, best loss: -0.9748729097862672] 38%|███▊      | 23/60 [3:28:41<5:35:16, 543.70s/trial, best loss: -0.9748729097862672] 40%|████      | 24/60 [3:37:39<5:25:07, 541.88s/trial, best loss: -0.9748729097862672] 42%|████▏     | 25/60 [3:46:37<5:15:31, 540.89s/trial, best loss: -0.9748729097862672] 43%|████▎     | 26/60 [3:55:32<5:05:30, 539.12s/trial, best loss: -0.9748729097862672] 45%|████▌     | 27/60 [4:04:45<4:58:42, 543.10s/trial, best loss: -0.9748729097862672] 47%|████▋     | 28/60 [4:13:45<4:49:14, 542.33s/trial, best loss: -0.9748729097862672] 48%|████▊     | 29/60 [4:23:02<4:42:25, 546.63s/trial, best loss: -0.9748729097862672] 50%|█████     | 30/60 [4:32:13<4:33:54, 547.83s/trial, best loss: -0.9748729097862672] 52%|█████▏    | 31/60 [4:41:15<4:24:01, 546.25s/trial, best loss: -0.9748729097862672] 53%|█████▎    | 32/60 [4:50:18<4:14:25, 545.21s/trial, best loss: -0.9748729097862672] 55%|█████▌    | 33/60 [4:59:26<4:05:42, 546.01s/trial, best loss: -0.9748729097862672] 57%|█████▋    | 34/60 [5:08:31<3:56:31, 545.84s/trial, best loss: -0.9748729097862672] 58%|█████▊    | 35/60 [5:17:38<3:47:32, 546.09s/trial, best loss: -0.9748729097862672] 60%|██████    | 36/60 [5:26:43<3:38:17, 545.72s/trial, best loss: -0.9748729097862672] 62%|██████▏   | 37/60 [5:35:50<3:29:20, 546.11s/trial, best loss: -0.9748729097862672] 63%|██████▎   | 38/60 [5:45:04<3:21:06, 548.48s/trial, best loss: -0.9748729097862672] 65%|██████▌   | 39/60 [5:54:13<3:12:00, 548.59s/trial, best loss: -0.9748729097862672] 67%|██████▋   | 40/60 [6:03:22<3:02:58, 548.90s/trial, best loss: -0.9748729097862672] 68%|██████▊   | 41/60 [6:12:25<2:53:13, 547.04s/trial, best loss: -0.9748729097862672] 70%|███████   | 42/60 [6:21:32<2:44:05, 546.99s/trial, best loss: -0.9748729097862672] 72%|███████▏  | 43/60 [6:30:36<2:34:44, 546.17s/trial, best loss: -0.9748729097862672] 73%|███████▎  | 44/60 [6:39:41<2:25:31, 545.74s/trial, best loss: -0.9748729097862672] 75%|███████▌  | 45/60 [6:48:45<2:16:18, 545.27s/trial, best loss: -0.9748729097862672] 77%|███████▋  | 46/60 [6:57:50<2:07:13, 545.24s/trial, best loss: -0.9748729097862672] 78%|███████▊  | 47/60 [7:07:00<1:58:25, 546.54s/trial, best loss: -0.9748729097862672] 80%|████████  | 48/60 [7:16:11<1:49:36, 548.02s/trial, best loss: -0.9748729097862672] 82%|████████▏ | 49/60 [7:25:16<1:40:18, 547.11s/trial, best loss: -0.9748729097862672] 83%|████████▎ | 50/60 [7:34:23<1:31:09, 546.99s/trial, best loss: -0.9748729097862672] 85%|████████▌ | 51/60 [7:43:26<1:21:52, 545.84s/trial, best loss: -0.9748729097862672] 87%|████████▋ | 52/60 [7:52:37<1:12:59, 547.38s/trial, best loss: -0.9748729097862672] 88%|████████▊ | 53/60 [8:01:33<1:03:26, 543.84s/trial, best loss: -0.9748729097862672] 90%|█████████ | 54/60 [8:10:32<54:14, 542.46s/trial, best loss: -0.9748729097862672]   92%|█████████▏| 55/60 [8:19:35<45:12, 542.54s/trial, best loss: -0.9748729097862672] 93%|█████████▎| 56/60 [8:28:41<36:14, 543.68s/trial, best loss: -0.9748729097862672] 95%|█████████▌| 57/60 [8:37:45<27:11, 543.73s/trial, best loss: -0.9748729097862672] 97%|█████████▋| 58/60 [8:46:45<18:05, 542.79s/trial, best loss: -0.9748729097862672] 98%|█████████▊| 59/60 [8:55:51<09:03, 543.67s/trial, best loss: -0.9748729097862672]100%|██████████| 60/60 [9:05:00<00:00, 545.11s/trial, best loss: -0.9748729097862672]100%|██████████| 60/60 [9:05:00<00:00, 545.00s/trial, best loss: -0.9748729097862672]
{'leaf_size': 5, 'n_neighbors': 1, 'weights': 'distance'}
Training Model with Tuned Parameters
Model test performance
{'class_names': ['Other', 'Root', 'WholePlant', 'Seedling', 'Seed', 'Shoot', 'Leaf', 'Flower', 'Inflorescence', 'Stigma', 'Internode', 'Hypotocyl', 'Cotyledon', 'Vasculature', 'Petal', 'Anther', 'Carpel', 'Root cell', 'Sepal', 'Petiole', 'Stamen', 'Pistil', 'Reproductive- Other'], 'label_encoding': [8, 13, 22, 16, 15, 18, 7, 3, 5, 20, 6, 4, 2, 21, 9, 0, 1, 14, 17, 10, 19, 11, 12], 'accuracy': 0.9809442060085837, 'precision': 0.9809992295358524, 'recall': 0.9809442060085837, 'f1_score': 0.9808299091353249, 'confusion_matrix': [[1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.9619047619047619, 0.0, 0.0, 0.0, 0.0, 0.0, 0.009523809523809525, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.02857142857142857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.01, 0.0, 0.0, 0.9, 0.0, 0.03, 0.0, 0.0, 0.02, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.04, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.9888888888888889, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.011111111111111112, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0005434782608695652, 0.0, 0.9929347826086956, 0.0005434782608695652, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.004347826086956522, 0.0, 0.0005434782608695652, 0.0, 0.0, 0.0005434782608695652, 0.0005434782608695652], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.012987012987012988, 0.9675324675324676, 0.0, 0.006493506493506494, 0.0, 0.0, 0.003246753246753247, 0.0, 0.00974025974025974, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6666666666666666, 0.0, 0.0, 0.3333333333333333, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0033500837520938024, 0.0, 0.0, 0.0, 0.0, 0.9949748743718593, 0.0, 0.0, 0.0016750418760469012, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.047619047619047616, 0.9523809523809523, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9873417721518988, 0.006329113924050633, 0.0, 0.0, 0.0, 0.0, 0.0, 0.006329113924050633], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.009781357882623706, 0.0005753739930955121, 0.0, 0.0, 0.0, 0.0, 0.0005753739930955121, 0.0, 0.0005753739930955121, 0.9815880322209436, 0.0, 0.004027617951668585, 0.0, 0.0, 0.0, 0.0028768699654775605], [0.0, 0.0, 0.0, 0.1111111111111111, 0.0, 0.0, 0.0, 0.0, 0.2222222222222222, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6666666666666666, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.015873015873015872, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0045351473922902496, 0.0, 0.0, 0.011337868480725623, 0.0, 0.9682539682539683, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0], [0.0, 0.1111111111111111, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8888888888888888, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003703703703703704, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003703703703703704, 0.0, 0.0, 0.03333333333333333, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9592592592592593]]}
Wrote model performance metrics to file: ../results/TissueClean/arabidopsis/KNN_performance.json
Saved model to file: ../results/TissueClean/arabidopsis/KNN_model.pickle
Done
