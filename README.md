### Expression-based machine learning models for predicting plant tissue identity

This repository contains all the python scripts and Jupyter notebooks required to reproduce the machine learning models, analyses, and figures presented in the manuscript [Expression-based machine learning models for predicting plant tissue identity](https://www.biorxiv.org/content/10.1101/2023.08.20.554029v2).

The analysis was performed in the following order:

- Data filtering and cleaning (`code/helper scripts`)
- Initial exploration with PCA (`run_arabidopsis_pca.ipynb`, `pca_AboveBelow_plots.ipynb`)
- Training and testing classification models (`run_arabidopsis_ml.py`, `run_angiosperm_ml.py`)
- Analyzing model performance (`visualize_model_performance.ipynb`)

The project is organized into following directories:

- `data`: Contains all the input gene expression data and metadata files.
- `code`: Contains all the python scripts and Jupyter notebooks.
- `results`: Contains results / intermediate data generated by the scripts - PCA coordinates, PC Loadings by genes, classifier performance metrics, etc.
- `plots`: All the plots and figures generated by the various scripts (may have been moved here from the `results` directory manually.

Please note that the actual data is not included in this repository due to size restrictions. But the code assumes that the data files are available in the `data` subdirecotry under the project root directory.

---


---

### Requirements
The code is written for Python 3.8 and has been tested with the following package configuration:

```
hyperopt==0.2.7
json5==0.9.5
matplotlib==3.4.3
numpy==1.20.3
pandas==1.3.3
scikit-learn==1.0
scipy==1.7.1
```

Most of these are standard python packages that are well maintained and are backward and forward compatible. So the code should work with older or newer versions of the packages (although we haven't tested it). The only uncommon packages is `hyperopt`. It can be installed via `pip`. For further information and documentation, check the following link: [hyperopt](http://hyperopt.github.io/hyperopt/). One last note: Due to the amount of data and computational resources involved, all the analyses were performed on MSU's HPC cluster. We have included the scripts used to schedule the jobs. We would advise against running the code on a personal computer.

---

If you find this code useful, please cite our paper:

```
@article {Palande2023.08.20.554029,
	author = {Sourabh Palande and Jeremy Arsenault and Patricia Basurto-Lozada and Andrew Bleich and Brianna N. I. Brown and Sophia F Buysse and Noelle A Connors and Sikta Das Adhikari and Kara C. Dobson and Francisco Xavier Guerra-Castillo and Maria F Guerrero-Carrillo and Sophia Harlow and Hector Herrera-Orozco and Asia T Hightower and Paulo Izquierdo and MacKenzie Jacobs and Nicholas A Johnson and Wendy Leuenberger and Alessandro Lopez-Hernandez and Alicia Luckie-Duque and Camila Martinez-Avila and Eddy Mendoza-Galindo and David Plancarte and Jenny M Schuster and Harry Shomer and Sidney C Sitar and Anne K. Steensma and Joanne Elise Thomson and Damian Villasenor-Amador and Robin Waterman and Brandon M Webster and Madison Whyte and Sofia Zorrilla-Azcue and Beronda L. Montgomery and Aman Y Husbands and Arjun Krishnan and Sarah Percival and Elizabeth Munch and Robert VanBuren and Daniel H Chitwood and Alejandra Rougon-Cardoso},
	title = {Expression-based machine learning models for predicting plant tissue identity},
	elocation-id = {2023.08.20.554029},
	year = {2024},
	doi = {10.1101/2023.08.20.554029},
	publisher = {Cold Spring Harbor Laboratory},
	URL = {https://www.biorxiv.org/content/early/2024/01/30/2023.08.20.554029},
	eprint = {https://www.biorxiv.org/content/early/2024/01/30/2023.08.20.554029.full.pdf},
	journal = {bioRxiv}
}
```
