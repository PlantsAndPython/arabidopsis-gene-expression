KNN True
Loading data...
Angiosperm RNAseq data shape: (2671, 6328)
Arabidopsis RNAseq data shape: (19415, 6328)
Number of all labels: (22086,)
Unique labels: ['Other', 'Root', 'WholePlant', 'Seedling', 'Seed', 'Shoot', 'Leaf', 'Flower', 'Inflorescence', 'Stigma', 'Internode', 'Hypotocyl', 'Cotyledon', 'Vasculature', 'Petal', 'Anther', 'Carpel', 'Root cell', 'Sepal', 'Petiole', 'Stamen', 'Pistil', 'Reproductive- Other']
Angio unique: ['Flower', 'Leaf', 'Root', 'Shoot', 'Other', 'Seed', 'Seedling', 'Reproductive- Other']
Arabi unique: ['Other', 'Root', 'WholePlant', 'Seedling', 'Seed', 'Shoot', 'Leaf', 'Flower', 'Inflorescence', 'Stigma', 'Internode', 'Hypotocyl', 'Cotyledon', 'Vasculature', 'Petal', 'Anther', 'Carpel', 'Root cell', 'Sepal', 'Petiole', 'Stamen', 'Pistil', 'Reproductive- Other']
Data loaded. Time elapsed: 18.16098123509437
Training data shapes: (13590, 6328), (13590,)
Test data shapes: (5825, 6328), (5825,)
Angio data shapes: (2671, 6328), (2671,)
Train / test splitting done. Time elapsed: 1.0845015468075871
Beginning Model Training and Selection using Hyperopt
  0%|          | 0/60 [00:00<?, ?trial/s, best loss=?]  2%|▏         | 1/60 [01:41<1:39:26, 101.13s/trial, best loss: -0.9683435098592944]  3%|▎         | 2/60 [03:11<1:31:28, 94.63s/trial, best loss: -0.9683435098592944]   5%|▌         | 3/60 [04:53<1:33:16, 98.18s/trial, best loss: -0.9683435098592944]  7%|▋         | 4/60 [06:40<1:34:54, 101.68s/trial, best loss: -0.9683435098592944]  8%|▊         | 5/60 [07:59<1:25:47, 93.59s/trial, best loss: -0.9683435098592944]  10%|█         | 6/60 [09:52<1:30:06, 100.12s/trial, best loss: -0.9683435098592944] 12%|█▏        | 7/60 [11:20<1:24:54, 96.12s/trial, best loss: -0.9683435098592944]  13%|█▎        | 8/60 [12:55<1:23:02, 95.82s/trial, best loss: -0.9683435098592944] 15%|█▌        | 9/60 [14:37<1:22:57, 97.60s/trial, best loss: -0.9683435098592944] 17%|█▋        | 10/60 [16:19<1:22:38, 99.18s/trial, best loss: -0.9683435098592944] 18%|█▊        | 11/60 [17:45<1:17:28, 94.86s/trial, best loss: -0.9683435098592944] 20%|██        | 12/60 [19:43<1:21:37, 102.04s/trial, best loss: -0.9683435098592944] 22%|██▏       | 13/60 [21:28<1:20:41, 103.02s/trial, best loss: -0.9683435098592944] 23%|██▎       | 14/60 [23:15<1:19:51, 104.17s/trial, best loss: -0.9683435098592944] 25%|██▌       | 15/60 [24:42<1:14:12, 98.94s/trial, best loss: -0.9683435098592944]  27%|██▋       | 16/60 [26:18<1:12:00, 98.19s/trial, best loss: -0.9683435098592944] 28%|██▊       | 17/60 [28:07<1:12:31, 101.20s/trial, best loss: -0.9683435098592944] 30%|███       | 18/60 [29:37<1:08:40, 98.10s/trial, best loss: -0.9683435098592944]  32%|███▏      | 19/60 [31:02<1:04:14, 94.01s/trial, best loss: -0.9683435098592944] 33%|███▎      | 20/60 [32:43<1:04:06, 96.16s/trial, best loss: -0.9683435098592944] 35%|███▌      | 21/60 [34:30<1:04:36, 99.39s/trial, best loss: -0.9683435098592944] 37%|███▋      | 22/60 [36:07<1:02:23, 98.52s/trial, best loss: -0.9683435098592944] 38%|███▊      | 23/60 [37:36<59:04, 95.79s/trial, best loss: -0.9683435098592944]   40%|████      | 24/60 [39:15<58:05, 96.81s/trial, best loss: -0.9683435098592944] 42%|████▏     | 25/60 [40:31<52:51, 90.61s/trial, best loss: -0.9683435098592944] 43%|████▎     | 26/60 [42:29<56:01, 98.87s/trial, best loss: -0.9683435098592944] 45%|████▌     | 27/60 [44:07<54:07, 98.42s/trial, best loss: -0.9683435098592944] 47%|████▋     | 28/60 [45:57<54:26, 102.09s/trial, best loss: -0.9683435098592944] 48%|████▊     | 29/60 [47:34<51:49, 100.30s/trial, best loss: -0.9683435098592944] 50%|█████     | 30/60 [49:34<53:14, 106.48s/trial, best loss: -0.9683435098592944] 52%|█████▏    | 31/60 [50:54<47:31, 98.33s/trial, best loss: -0.9683435098592944]  53%|█████▎    | 32/60 [52:30<45:35, 97.71s/trial, best loss: -0.9683435098592944] 55%|█████▌    | 33/60 [54:20<45:34, 101.27s/trial, best loss: -0.9683435098592944] 57%|█████▋    | 34/60 [55:51<42:35, 98.30s/trial, best loss: -0.9683435098592944]  58%|█████▊    | 35/60 [57:58<44:36, 107.05s/trial, best loss: -0.9683435098592944] 60%|██████    | 36/60 [59:31<41:07, 102.81s/trial, best loss: -0.9683435098592944] 62%|██████▏   | 37/60 [1:00:49<36:30, 95.24s/trial, best loss: -0.9683435098592944] 63%|██████▎   | 38/60 [1:02:36<36:16, 98.92s/trial, best loss: -0.9683435098592944] 65%|██████▌   | 39/60 [1:04:59<39:10, 111.95s/trial, best loss: -0.9683435098592944] 67%|██████▋   | 40/60 [1:06:55<37:41, 113.09s/trial, best loss: -0.9683435098592944] 68%|██████▊   | 41/60 [1:08:40<35:06, 110.88s/trial, best loss: -0.9683435098592944] 70%|███████   | 42/60 [1:10:39<33:55, 113.08s/trial, best loss: -0.9683435098592944] 72%|███████▏  | 43/60 [1:12:04<29:39, 104.70s/trial, best loss: -0.9683435098592944] 73%|███████▎  | 44/60 [1:13:27<26:10, 98.15s/trial, best loss: -0.9683435098592944]  75%|███████▌  | 45/60 [1:15:08<24:47, 99.19s/trial, best loss: -0.9683435098592944] 77%|███████▋  | 46/60 [1:16:57<23:51, 102.22s/trial, best loss: -0.9683435098592944] 78%|███████▊  | 47/60 [1:18:38<22:02, 101.70s/trial, best loss: -0.9683435098592944] 80%|████████  | 48/60 [1:20:26<20:43, 103.63s/trial, best loss: -0.9683435098592944] 82%|████████▏ | 49/60 [1:21:56<18:13, 99.45s/trial, best loss: -0.9683435098592944]  83%|████████▎ | 50/60 [1:23:38<16:42, 100.28s/trial, best loss: -0.9683435098592944] 85%|████████▌ | 51/60 [1:25:19<15:03, 100.39s/trial, best loss: -0.9683435098592944] 87%|████████▋ | 52/60 [1:27:02<13:31, 101.39s/trial, best loss: -0.9683435098592944] 88%|████████▊ | 53/60 [1:28:52<12:07, 103.99s/trial, best loss: -0.9683435098592944] 90%|█████████ | 54/60 [1:30:42<10:34, 105.75s/trial, best loss: -0.9683435098592944] 92%|█████████▏| 55/60 [1:32:25<08:43, 104.73s/trial, best loss: -0.9683435098592944] 93%|█████████▎| 56/60 [1:34:19<07:10, 107.75s/trial, best loss: -0.9683435098592944] 95%|█████████▌| 57/60 [1:35:46<05:03, 101.31s/trial, best loss: -0.9683435098592944] 97%|█████████▋| 58/60 [1:37:25<03:21, 100.64s/trial, best loss: -0.9683435098592944] 98%|█████████▊| 59/60 [1:39:05<01:40, 100.47s/trial, best loss: -0.9683435098592944]100%|██████████| 60/60 [1:40:40<00:00, 98.84s/trial, best loss: -0.9683435098592944] 100%|██████████| 60/60 [1:40:40<00:00, 100.67s/trial, best loss: -0.9683435098592944]
{'leaf_size': 6, 'n_neighbors': 1, 'weights': 'distance'}
Training Model with Tuned Parameters
Test performance metrics
{'class_names': ['Other', 'Root', 'WholePlant', 'Seedling', 'Seed', 'Shoot', 'Leaf', 'Flower', 'Inflorescence', 'Stigma', 'Internode', 'Hypotocyl', 'Cotyledon', 'Vasculature', 'Petal', 'Anther', 'Carpel', 'Root cell', 'Sepal', 'Petiole', 'Stamen', 'Pistil', 'Reproductive- Other'], 'label_encoding': [8, 13, 22, 16, 15, 18, 7, 3, 5, 20, 6, 4, 2, 21, 9, 0, 1, 14, 17, 10, 19, 11, 12], 'arabidopsis': {'accuracy': 0.9752789699570815, 'precision': 0.975516907004961, 'recall': 0.9752789699570815, 'f1_score': 0.9749795880550803, 'confusion_matrix': [[1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.8, 0.0, 0.0, 0.0, 0.0, 0.01904761904761905, 0.0380952380952381, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.12380952380952381, 0.0, 0.01904761904761905, 0.0, 0.0, 0.0, 0.0], [0.01, 0.0, 0.0, 0.89, 0.0, 0.07, 0.0, 0.0, 0.02, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.011111111111111112, 0.0, 0.9666666666666667, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.011111111111111112, 0.0, 0.011111111111111112, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0005434782608695652, 0.0, 0.9907608695652174, 0.0010869565217391304, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.004891304347826087, 0.0, 0.0016304347826086956, 0.0, 0.0, 0.0005434782608695652, 0.0005434782608695652], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.012987012987012988, 0.9512987012987013, 0.0, 0.006493506493506494, 0.003246753246753247, 0.0, 0.00974025974025974, 0.0, 0.012987012987012988, 0.003246753246753247, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.0, 0.8, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6666666666666666, 0.0, 0.0, 0.3333333333333333, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0033500837520938024, 0.0, 0.0, 0.0, 0.0, 0.9932998324958124, 0.0, 0.0, 0.0033500837520938024, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.14285714285714285, 0.8095238095238095, 0.0, 0.047619047619047616, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.012658227848101266, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.9746835443037974, 0.006329113924050633, 0.0, 0.0, 0.0, 0.0, 0.0, 0.006329113924050633], [0.0, 0.0, 0.0, 0.0005753739930955121, 0.0, 0.0, 0.0, 0.00863060989643268, 0.0023014959723820483, 0.0, 0.0, 0.0, 0.0, 0.0005753739930955121, 0.0, 0.0005753739930955121, 0.9821634062140391, 0.0, 0.0017261219792865361, 0.0, 0.0, 0.0, 0.0034522439585730723], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2222222222222222, 0.1111111111111111, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6666666666666666, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.015873015873015872, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0045351473922902496, 0.0, 0.0, 0.011337868480725623, 0.0, 0.9682539682539683, 0.0, 0.0, 0.0, 0.0], [0.14285714285714285, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.8571428571428571, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.007407407407407408, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.018518518518518517, 0.0, 0.007407407407407408, 0.0, 0.0, 0.0, 0.9666666666666667]]}, 'angiosperm': {'accuracy': 0.523399475851741, 'precision': 0.5159430101128336, 'recall': 0.523399475851741, 'f1_score': 0.4902029983196198, 'confusion_matrix': [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.10683760683760683, 0.03418803418803419, 0.0, 0.038461538461538464, 0.0, 0.05982905982905983, 0.07692307692307693, 0.004273504273504274, 0.0, 0.004273504273504274, 0.32905982905982906, 0.06837606837606838, 0.06837606837606838, 0.0, 0.07264957264957266, 0.13675213675213677, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0009074410163339383, 0.0009074410163339383, 0.0, 0.0, 0.7304900181488203, 0.023593466424682397, 0.0, 0.0, 0.0009074410163339383, 0.016333938294010888, 0.0, 0.1851179673321234, 0.0018148820326678765, 0.036297640653357534, 0.0018148820326678765, 0.0, 0.0018148820326678765], [0.0, 0.024691358024691357, 0.0, 0.0, 0.0, 0.345679012345679, 0.07407407407407407, 0.0, 0.0, 0.0, 0.2962962962962963, 0.09876543209876543, 0.14814814814814814, 0.0, 0.0, 0.012345679012345678, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.006230529595015576, 0.0, 0.003115264797507788, 0.003115264797507788, 0.32087227414330216, 0.012461059190031152, 0.0, 0.0, 0.0, 0.19314641744548286, 0.1277258566978193, 0.2118380062305296, 0.0, 0.04984423676012461, 0.006230529595015576, 0.04672897196261682, 0.018691588785046728], [0.002074688796680498, 0.0, 0.0, 0.0, 0.0, 0.008298755186721992, 0.004149377593360996, 0.0, 0.0, 0.0, 0.9647302904564315, 0.006224066390041493, 0.01037344398340249, 0.0, 0.0, 0.004149377593360996, 0.0, 0.0], [0.0, 0.0, 0.09302325581395349, 0.0, 0.0, 0.03488372093023256, 0.011627906976744186, 0.0, 0.0, 0.0, 0.3953488372093023, 0.37209302325581395, 0.05813953488372093, 0.0, 0.005813953488372093, 0.01744186046511628, 0.011627906976744186, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.44966442953020136, 0.006711409395973154, 0.0, 0.0, 0.0, 0.2214765100671141, 0.006711409395973154, 0.2348993288590604, 0.0, 0.08053691275167785, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.015384615384615385, 0.0, 0.0, 0.007692307692307693, 0.2076923076923077, 0.06923076923076923, 0.0, 0.007692307692307693, 0.0, 0.2153846153846154, 0.0, 0.34615384615384615, 0.0, 0.11538461538461539, 0.007692307692307693, 0.0, 0.007692307692307693], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]}}
Wrote model performance metrics to file: ../results/TissueClean/angiosperm/KNN_performance.json
Saved model to file: ../results/TissueClean/angiosperm/KNN_model.pickle
Saved angiosperm metadata to file: ../results/TissueClean/angiosperm/KNN_metadata.csv
Done
